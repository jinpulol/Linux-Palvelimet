# h5 - Nimittäin

Viidennellä viikolla tehtävät keskittyivät verkkotunnukseen eli domainiin. Tehtävien yhteydessä oli mahdollisuus myös vuokrata omalle weppipalvelimelle domain-nimi, käyttämällä esimerkiksi [GitHub Educationin](https://education.github.com/) ilmaisia domain-nimiä. Domain-nimen vuokraaminen onnistui myös tuotantoonkin kelpaavilta palveluntarjoajilta, esimerkiksi [NameCheapiltä](https://www.namecheap.com/). Tehtävien tarkemmat kuvaukset löytyvät opettajan [sivuilta](https://terokarvinen.com/2023/linux-palvelimet-2023-alkusyksy/#h5-nimittain).

Tämän viikon lukutehtävien artikkelit olivat kurssin opettajan, Tero Karvisen kirjoittamat artikkelit [New Default Website with Apache2](https://terokarvinen.com/2016/02/16/new-default-website-with-apache2-show-your-homepage-at-top-of-example-com-no-tilde/) ja [Name Based Virtual Hosts on Apache](https://terokarvinen.com/2018/04/10/name-based-virtual-hosts-on-apache-multiple-websites-to-single-ip-address/) sekä Apache Software Foundationin dokumentti [Name-based Virtual Host Support](https://httpd.apache.org/docs/2.4/vhosts/name-based.html).

## x) Lue ja tiivistä

### Tero Karvinen, New Default Website with Apache2 – Show your homepage at top of example.com, no tilde

- Artikkelin opasta seuratakseen, edellisten viikkojen opit ovat tarpeen. Ilman perustietämystä artikkelin opastusta voi olla hankala toteuttaa.
- Apachessa VirtualHost (virtuaalipalvelin) vastaa lähes samaa kuin verkkosivusto. Yksittäinen Apache-palvelin voi pitää sisällään useammankin virtuaalipalvelimen.
  - Jokainen virtuaalipalvelin on määritetty yhdelle conf-tiedostolle /etc/apache2/sites-available/ -hakemistossa.
  - Jokaisella saatavilla olevalla virtuaalipalvelimella on symlinkki (symbolinen linkki, jolla [viitataan](https://www.linux.fi/wiki/Symbolinen_linkki) toisaalle) /etc/apache2/sites-enabled/ -hakemistoon.
    - Virtuaalipalvelimen ottaminen käyttöön käy komennolla ``$ sudo a2ensite sivu.conf`` (apache2 enable site).
    - Virtuaalipalvelimen ottaminen pois käytöstä komennolla ``$ sudo a2dissite sivu.conf`` (apache2 disable site).
      - _Materiaalissa ``a2dismod`` (disable module), myöhemmin oppaassa kuitenkin ``a2dissite``._
- Uuden virtuaalipalvelimen voi luoda luomalla uuden conf-tiedoston /etc/apache2/sites-available/ -hakemistoon. Tiedostonimessä ei saa olla erikoismerkkejä.
  - Virtuaalipalvelimen conf-tiedostoa muokataan artikkelin mallin mukaisesti:
  
 		## /etc/apache2/sites-enabled/sivu.conf
		<VirtualHost *:80>
		DocumentRoot /home/jesse/public_html/
		<Directory /home/jesse/public_html/>
 		Require all granted
		</Directory>
		</VirtualHost>

    - Virtuaalipalvelin kuuntelee porttia 80 (HTTP-protokolla).
    - Lisätään DocumentRoot. DocumentRoot on polku hakemistolle, mikä sisältää kaikki sivustosi html-tiedostot.
    - Annetaan Apachelle lupa käyttää kyseisen hakemiston tiedostoja.
- Vanhan virtuaalipalvelimen (oletussivun) symlinkin voi ottaa pois käytöstä, kun uusi virtuaalipalvelin on valmis otettavaksi käyttöön.
	- Uudelle virtuaalipalvelimelle on syytä luoda kotisivut ennen käyttöönottoa. Tällöin välttää virheilmoitukset sivustolla vieraillessa.

### Tero Karvinen, Name Based Virtual Hosts on Apache – Multiple Websites to Single IP Address

- Moni artikkelin asia oli toistoa ensimmäisestä.
- Apachella voi pitää useampia domain-nimiä yhdellä IP-osoitteella.
- Testaaminen onnistuu esimerkiksi seuraamalla artikkelin vaiheita.
  - Muokataan Apachen oletussivua.
  - Luodaan ja otetaan käyttöön uusi virtuaalipalvelin (kohtia avattu edellisen artikkelin kohdalla).
  - Luodaan uusi html-tiedosto virtuaalipalvelimen DocumentRoot-hakemistoon.
  - Testataan esimerkiksi curl-komennoilla tai avaamalla selaimessa localhost ja juuri luotu html-sivu.
    - Tuotantoympäristössä käytössä olisi oikeita domaineja. Näitä voi simuloida lisäämällä palvelimia /etc/hosts/ -tiedostoon.

### Apache Software Foundation, Name-based Virtual Host Support

#### Name-based vs IP-based Virtual Hosts

- IP-pohjaiset virtuaalipalvelimet käyttävät nimensä mukaisesti IP-osoitetta oikean virtuaalipalvelimen määrittämiseksi ja siksi tarvitsevat jokaiselle erilliselle palvelimelle oman IP-osoitteen.
- Nimipohjaiset virtuaalipalvelimet käyttävät HTTP-protokollan otsikkotietoja (headers) palvelimen tunnistamiseksi. Tällöin IP-osoitteessa voi olla useampi eri palvelin.


## a) Domain-nimen vuokraaminen



## b) Nimen tutkiminen

## c) Etusivu uusiksi

## Lähteet

Tero Karvinen
- 

GitHub Education
- https://education.github.com/

NameCheap
- https://www.namecheap.com/

Linux.fi
- https://www.linux.fi/wiki/Symbolinen_linkki
